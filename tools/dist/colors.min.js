const RGB=function(r,g,b){this.r=+r,this.g=+g,this.b=+b},HSL=function(h,s,l){this.h=+h,this.s=+s,this.l=+l},CMYK=function(c,m,y,k){this.c=+c,this.m=+m,this.y=+y,this.k=+k},COLOR=function(o,t){this.rgb=new RGB(0,0,0),this.hsl=new HSL(0,0,0),this.cmyk=new CMYK(0,0,0,0),this.hex="000000",void 0===t?COLOR.hexReg.test(o)?t="hex":o instanceof RGB?t="rgb":COLOR.rgbReg.test(o)?t="rgbs":o instanceof HSL?t="hsl":COLOR.hslReg.test(o)?t="hsls":/[a-zA-z]+/.test(o)?t="word":"object"==typeof o&&(void 0!==o.r&&(t="rgb"),void 0!==o.h&&(t="hsl")):(this.setVal(t,o),this.updateVals(t))};COLOR.hexReg=/^#?[0-9a-fA-F]{3,6}/,COLOR.rgbReg=/^rgba?\((\d+),\s*(\d+),\s*(\d+)[,\d\.]*\)/,COLOR.hslReg=/^hsla?\((\d+),\s*(\d+)%,\s*(\d+)%[,\d\.]*\)/,COLOR.prototype.setVal=function(k,v){var reg;switch(k=k||"r"){case"r":case"g":case"b":this.rgb[k]=v,k="rgb";break;case"rgb":Object.assign(this.rgb,v);break;case"rgbs":reg=COLOR.rgbReg.exec(v),Object.assign(this.rgb,new RGB(reg[1],reg[2],reg[3])),k="rgb";break;case"h":case"s":case"l":this.hsl[k]=v,k="hsl";break;case"hsl":Object.assign(this.hsl,v);break;case"hsls":reg=COLOR.hslReg.exec(v),Object.assign(this.hsl,new HSL(reg[1],reg[2],reg[3])),k="hsl";break;case"c":case"m":case"y":case"k":this.cmyk[k]=v,k="cmyk";break;case"cmyk":Object.assign(this.cmyk,v);break;case"hex":v="#"==v[0]?v.substr(1):v,this.hex=3==v.length?v[0]+v[0]+v[1]+v[1]+v[2]+v[2]:v;break;case"word":this.hex=this.wordToHex(v),k="hex"}return this.updateVals(k),this},COLOR.prototype.updateVals=function(k){switch(k){case"rgb":this.rgbToHsl().rgbToCmyk().rgbToHex();break;case"hsl":this.hslToRgb().rgbToCmyk().rgbToHex();break;case"cmyk":this.cmykToRgb().rgbToHsl().rgbToHex();break;case"hex":this.hexToRgb().rgbToHsl().rgbToCmyk()}return this},COLOR.prototype.rgbToHsl=function(){var h,s,r=this.rgb.r/255,g=this.rgb.g/255,b=this.rgb.b/255,max=Math.max(r,g,b),min=Math.min(r,g,b),l=(max+min)/2;if(max==min)h=s=0;else{var d=max-min;switch(s=l>.5?d/(2-max-min):d/(max+min),max){case r:h=(g-b)/d+(g<b?6:0);break;case g:h=(b-r)/d+2;break;case b:h=(r-g)/d+4}h/=6}return this.hsl.h=360*h,this.hsl.s=100*s,this.hsl.l=100*l,this},COLOR.prototype.rgbToCmyk=function(){var r=this.rgb.r/255,g=this.rgb.g/255,b=this.rgb.b/255,k=Math.min(1-r,1-g,1-b),c=(1-r-k)/(1-k),m=(1-g-k)/(1-k),y=(1-b-k)/(1-k);return this.cmyk.c=255*c||0,this.cmyk.m=255*m||0,this.cmyk.y=255*y||0,this.cmyk.k=255*k,this},COLOR.prototype.rgbToHex=function(){return this.hex=("0"+Math.round(this.rgb.r).toString(16)).substr(-2)+("0"+Math.round(this.rgb.g).toString(16)).substr(-2)+("0"+Math.round(this.rgb.b).toString(16)).substr(-2),this},COLOR.prototype.hslToRgb=function(){var r,g,b,h=this.hsl.h/360,s=this.hsl.s/100,l=this.hsl.l/100;if(0==s)r=g=b=l;else{var q=l<.5?l*(1+s):l+s-l*s,p=2*l-q;r=this.hue2rgb(p,q,h+1/3),g=this.hue2rgb(p,q,h),b=this.hue2rgb(p,q,h-1/3)}return this.rgb.r=255*r,this.rgb.g=255*g,this.rgb.b=255*b,this},COLOR.prototype.wordToHex=function(str){var ctx=document.createElement("canvas").getContext("2d");return ctx.fillStyle=str,ctx.fillStyle.substr(1)},COLOR.prototype.hue2rgb=function(p,q,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?p+6*(q-p)*t:t<.5?q:t<2/3?p+(q-p)*(2/3-t)*6:p},COLOR.prototype.cmykToRgb=function(){var c=this.cmyk.c/100,m=this.cmyk.m/100,y=this.cmyk.y/100,k=this.cmyk.k/100,r=1-Math.min(1,c*(1-k)+k),g=1-Math.min(1,m*(1-k)+k),b=1-Math.min(1,y*(1-k)+k);return this.rgb.r=255*r,this.rgb.g=255*g,this.rgb.b=255*b,this},COLOR.prototype.hexToRgb=function(){return this.rgb.r=parseInt(this.hex.substr(0,2),16),this.rgb.g=parseInt(this.hex.substr(2,2),16),this.rgb.b=parseInt(this.hex.substr(4,2),16),this},COLOR.prototype.toString=function(type,alpha){switch(type){case"rgb":return`rgb(${Math.round(this.rgb.r)},${Math.round(this.rgb.g)},${Math.round(this.rgb.b)})`;case"rgba":return`rgba(${Math.round(this.rgb.r)},${Math.round(this.rgb.g)},${Math.round(this.rgb.b)},${alpha})`;case"rgbv":return`${Math.round(this.rgb.r)},${Math.round(this.rgb.g)},${Math.round(this.rgb.b)}`;case"hsl":return`hsl(${Math.round(this.hsl.h)},${Math.round(this.hsl.s)}%,${Math.round(this.hsl.l)}%)`;case"hsla":return`hsla(${Math.round(this.hsl.h)},${Math.round(this.hsl.s)}%,${Math.round(this.hsl.l)}%,${alpha})`;case"hslv":return`${Math.round(this.hsl.h)},${Math.round(this.hsl.s)}%,${Math.round(this.hsl.l)}%`;case"cmyk":return`cmyk(${Math.round(this.cmyk.c)},${Math.round(this.cmyk.m)},${Math.round(this.cmyk.y)},${Math.round(this.cmyk.k)})`;case"hex":return"#"+this.hex}};